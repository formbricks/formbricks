import { MdxImage } from "@/components/MdxImage";

import ConnectWithGoogle from "./connect-with-google.webp";
import DeleteConnection from "./delete-connection.webp";
import GoogleConnected from "./google-connected.webp";
import IntegrationTab from "./integrations-tab.webp";
import LinkSurveyWithSheet from "./link-survey-with-sheet.webp";
import LinkWithQuestions from "./link-with-questions.webp";
import ListLinkedSurveys from "./list-linked-surveys.webp";

export const metadata = {
  title: "Google Sheets",
  description:
    "The Google Sheets integration allows you to automatically send responses to a Google Sheet of your choice.",
};

#### Integrations

# Google Sheets

The Google Sheets integration allows you to automatically send responses to a Google Sheet of your choice.

<Note>
  If you are on a self-hosted instance, you will need to configure this integration separately. Please follow
  the guides [here](/self-hosting/integrations) to configure integrations on your self-hosted instance.
</Note>

## Connect Google Sheets

1. Go to the Integrations tab in your [Formbricks Cloud dashboard](https://app.formbricks.com/) and click on the "Connect" button under Google Sheets integration.

<MdxImage
  src={IntegrationTab}
  alt="Formbricks Integrations Tab"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

2. Now click on the "Connect with Google" button to authenticate yourself with Google.

<MdxImage
  src={ConnectWithGoogle}
  alt="Connect Formbricks with your Google"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

3. You will now be taken to the Google OAuth page where you can select the Google account you want to use for the integration.

4. Once you have selected the account and completed the authentication process, you will be taken back to Formbricks Cloud and see the connected status as below:

<MdxImage
  src={GoogleConnected}
  alt="Formbricks is now connected with Google"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

<Note>

Before the next step, make sure that you have a Formbricks Survey with at least one question and a Google Sheet in the Google account you integrated.

</Note>

5. Now click on the "Link New Sheet" button to link a Google Sheet with Formbricks and a modal will open up.

<MdxImage
  src={LinkSurveyWithSheet}
  alt="Link Formbricks with a Google Sheet"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

6. Enter the spreadsheet URL for the Google Sheet you want to link with Formbricks and the Survey. On doing so, you will be asked with what questions' responses you want to feed in the Google Sheet. Select the questions and click on the "Link Sheet" button.

<MdxImage
  src={LinkWithQuestions}
  alt="Select question to link with Google Sheet"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

7. On submitting, the modal will close and you will see the linked Google Sheet in the list of linked Google Sheets.

<MdxImage
  src={ListLinkedSurveys}
  alt="List of linked Google Sheets"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

Congratulations! You have successfully linked a Google Sheet with Formbricks. Now whenever a response is submitted for the linked survey, it will be automatically added to the linked Google Sheet.

## Remove Integration with Google Account

To remove the integration with Google Account,

1. Visit the Integrations tab in your Formbricks Cloud dashboard.
2. Select **Manage Sheets** button in the Google Sheets card.
3. Click on the **Delete Integration** button.
4. It will now ask for a confirmation to remove the integration. Click on the **Delete** button to remove the integration. You can always come back and connect again with the same Google Account.

<MdxImage
  src={DeleteConnection}
  alt="Delete Google Integration with Formbricks"
  quality="100"
  className="max-w-full rounded-lg sm:max-w-3xl"
/>

## What info do you need?

- Your **Email ID** for authentication (We use this to identify you)
- Your **Google Sheets Names and IDs** (We fetch this to list and show you the options of choosing a sheet to integrate with)
- Write access to **selected Google Sheet** (The google sheet you choose to integrate it with, we write survey responses to it)

For the above, we ask for:

1. **User Email**: To identify you (that's it, nothing else, we're opensource, see this in our codebase [here](https://github.com/formbricks/formbricks/blob/main/apps/web/app/api/google-sheet/callback/route.ts#L47C17-L47C25))
1. **Google Spreadsheet API**: To write to the spreadsheet you select (that's it, nothing else, we're opensource, see this method in our codebase [here](https://github.com/formbricks/formbricks/blob/main/packages/lib/googleSheet/service.ts#L70))

<Note>We store as little personal information as possible.</Note>

Still struggling or something not working as expected? [Join our Github Discussions](https://github.com/formbricks/formbricks/discussions) and we'd be glad to assist you!
